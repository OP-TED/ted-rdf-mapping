#--- technical_mapping_F03.rml.ttl ---
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix skos: <http://www.w3.org/2004/02/skos/core#> .
@prefix rr: <http://www.w3.org/ns/r2rml#> .
@prefix rml: <http://semweb.mmlab.be/ns/rml#> .
@prefix ql: <http://semweb.mmlab.be/ns/ql#> .
@prefix locn: <http://www.w3.org/ns/locn#> .
@prefix dct: <http://purl.org/dc/terms/> .
@prefix tedm: <http://data.europa.eu/a4g/mapping/sf-rml/> .
@prefix epo: <http://data.europa.eu/a4g/ontology#> .
@prefix epd: <http://data.europa.eu/a4g/resource/> .
@prefix cv: <http://data.europa.eu/m8g/> .
@prefix cccev: <http://data.europa.eu/m8g/> .
@prefix org: <http://www.w3.org/ns/org#> .
@prefix cpov: <http://data.europa.eu/m8g/> .

# copy into the mapping_suite_f03, this file and all the imports.
tedm:technical_mapping_f03
  a owl:Ontology ;
  owl:imports 	tedm:contracting_authority, tedm:object, tedm:procedure, tedm:award_of_contract, tedm:complementary_information, tedm:annexe_d1, tedm:notice;
  dct:description "This module provides the mapping definitions for the F03 form"@en ;
  rdfs:label "TED-SWS mapping of F03"@en ;  
  dct:date "2022-05-11"^^xsd:date .
#Section 1
# Buyer Profile & Organisation
tedm:BuyerOrganisationGroup a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014/CONTRACTING_BODY/ADDRESS_CONTRACTING_BODY_ADDITIONAL[1]" ;
            rml:referenceFormulation ql:XPath
        ] ;
    rr:subjectMap
        [
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-')}_BuyerOrganisationGroup_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw')}" ;
            rr:class epo:OrganisationGroup

        ] .
tedm:OrganisationIdentifier a rr:TriplesMap ;
    rr:subjectMap
        [
            rml:reference "if (exists(NATIONALID)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-') || '_OrganisationIdentifier_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
            rr:class epo:Identifier
        ] ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014[1]/CONTRACTING_BODY/ADDRESS_CONTRACTING_BODY";
            rml:referenceFormulation ql:XPath
        ].
tedm:ContactPoint a rr:TriplesMap ;
    rr:subjectMap
        [
            rml:reference "if(exists(E_MAIL) or exists(FAX) or exists(PHONE) or exists(URL_GENERAL) or exists(CONTACT_POINT)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-') || '_ContactPoint_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
            rr:class cpov:ContactPoint

        ] ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014/CONTRACTING_BODY/ADDRESS_CONTRACTING_BODY" ;
            rml:referenceFormulation ql:XPath
        ] .
tedm:OrganisationAddress  a rr:TriplesMap ;
    rr:subjectMap
        [
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-')}_OrganisationAddress_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw')}" ;
            rr:class locn:Address

        ] ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014[1]/CONTRACTING_BODY/ADDRESS_CONTRACTING_BODY" ;
            rml:referenceFormulation ql:XPath
        ] .

tedm:AdditionalOrganisationIdentifier a rr:TriplesMap ;
    rr:subjectMap
        [
            rml:reference "if (exists(NATIONALID)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-') || '_OrganisationIdentifier_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
            rr:class epo:Identifier
        ] ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014[1]/CONTRACTING_BODY/ADDRESS_CONTRACTING_BODY_ADDITIONAL";
            rml:referenceFormulation ql:XPath
        ].
tedm:AdditionalContactPoint a rr:TriplesMap ;
    rr:subjectMap
        [
            rml:reference "if(exists(E_MAIL) or exists(FAX) or exists(PHONE) or exists(URL_GENERAL) or exists(CONTACT_POINT)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-') || '_AdditionalContactPoint_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
            rr:class cpov:ContactPoint

        ] ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014/CONTRACTING_BODY/ADDRESS_CONTRACTING_BODY_ADDITIONAL" ;
            rml:referenceFormulation ql:XPath
        ] .
tedm:AdditionalOrganisationAddress  a rr:TriplesMap ;
    rr:subjectMap
        [
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-')}_OrganisationAddress_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw')}" ;
            rr:class locn:Address

        ] ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014[1]/CONTRACTING_BODY/ADDRESS_CONTRACTING_BODY_ADDITIONAL" ;
            rml:referenceFormulation ql:XPath
        ] .
tedm:AdditionalOrganisation a rr:TriplesMap ;
    rr:subjectMap
        [
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-')}_AdditionalOrganisation_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw')}" ;
            rr:class org:Organization

        ] ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014/CONTRACTING_BODY/ADDRESS_CONTRACTING_BODY_ADDITIONAL" ;
            rml:referenceFormulation ql:XPath
        ] .

tedm:AdditionalBuyerCP a rr:TriplesMap;
    rr:subjectMap
        [
        rml:reference "if (exists(/TED_EXPORT/FORM_SECTION/F03_2014/CONTRACTING_BODY/CENTRAL_PURCHASING)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-') || '_AdditionalBuyer_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
        rr:class epo:Buyer
#            rr:class epo:AwardingCentralPurchasingBody

        ] ;
    rml:logicalSource
    [
        rml:source "data/source.xml" ;
        rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014/CONTRACTING_BODY/ADDRESS_CONTRACTING_BODY_ADDITIONAL" ;
        rml:referenceFormulation ql:XPath
    ] .
tedm:AdditionalBuyer a rr:TriplesMap;
    rr:subjectMap
        [
        rml:reference "if (not(exists(/TED_EXPORT/FORM_SECTION/F03_2014/CONTRACTING_BODY/CENTRAL_PURCHASING))) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-') || '_AdditionalBuyer_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;

            rr:class epo:Buyer

        ] ;
    rml:logicalSource
    [
        rml:source "data/source.xml" ;
        rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014/CONTRACTING_BODY/ADDRESS_CONTRACTING_BODY_ADDITIONAL" ;
        rml:referenceFormulation ql:XPath
    ] .
tedm:Organisation a rr:TriplesMap ;
    rr:subjectMap
        [
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-')}_Organisation_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw')}" ;
            rr:class org:Organization

        ] ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014/CONTRACTING_BODY/ADDRESS_CONTRACTING_BODY" ;
            rml:referenceFormulation ql:XPath
        ] .
tedm:Buyer a rr:TriplesMap;
    rr:subjectMap
        [
        rml:reference "if (not(exists(/TED_EXPORT/FORM_SECTION/F03_2014/CONTRACTING_BODY/CENTRAL_PURCHASING))) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-') || '_Buyer_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
        rr:class epo:Buyer

        ] ;
    rml:logicalSource
    [
        rml:source "data/source.xml" ;
        rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014[1]/CONTRACTING_BODY" ;
        rml:referenceFormulation ql:XPath
    ] .

tedm:BuyerCP a rr:TriplesMap;
    rr:subjectMap
        [
        rml:reference "if (exists(/TED_EXPORT/FORM_SECTION/F03_2014/CONTRACTING_BODY/CENTRAL_PURCHASING)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-') || '_Buyer_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
        rr:class epo:Buyer
#        rr:class epo:AwardingCentralPurchasingBody

        ] ;
    rml:logicalSource
    [
        rml:source "data/source.xml" ;
        rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014[1]/CONTRACTING_BODY" ;
        rml:referenceFormulation ql:XPath
    ] .
tedm:NoticeAwardInformation a rr:TriplesMap ;
    rr:subjectMap
        [
            rml:reference "if (exists(VAL_TOTAL) or exists(VAL_RANGE_TOTAL/LOW) or exists(VAL_RANGE_TOTAL/HIGH)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-') || '_NoticeAwardInformation_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
            rr:class epo:NoticeAwardInformation
        ] ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014[1]/OBJECT_CONTRACT" ;
            rml:referenceFormulation ql:XPath
        ] .
tedm:Notice a rr:TriplesMap ;
    rr:subjectMap
        [
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-')}_Notice" ;
            rr:class epo:Notice
        ] ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014[1]/OBJECT_CONTRACT" ;
            rml:referenceFormulation ql:XPath
        ] ;
    rr:predicateObjectMap     # second (more specific) notice type - will be added in the tedm:notice module if multiple types are possible
        [
            rr:predicate rdf:type ;
            rr:objectMap
            [
                rr:constant epo:ResultNotice;
            ]
        ] .
tedm:NoticeIdentifier a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014[1]/OBJECT_CONTRACT";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-')}_NoticeIdentifier_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw')}" ;
            rr:class epo:Identifier
        ] .
tedm:PlannedProcurementPart a rr:TriplesMap ;
    rr:subjectMap
        [
            rml:reference "if (exists(DATE_PUBLICATION_NOTICE)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-') || '_PlannedProcurementPart_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
            rr:class epo:PlannedProcurementPart
        ] ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014[1]/OBJECT_CONTRACT" ;
            rml:referenceFormulation ql:XPath
       ] .
tedm:ProcessPlanningTermLot a rr:TriplesMap ;
    rr:subjectMap
        [
            rml:reference "if (exists(DATE_PUBLICATION_NOTICE)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-') || '_ProcessPlanningTerm_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
            rr:class epo:ProcessPlanningTerm
        ] ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014[1]/OBJECT_CONTRACT" ;
            rml:referenceFormulation ql:XPath
       ] .
# Commenting this out as this is not an appropriate mapping for the field IV.2.5. EPO 3.1.0 does not provide an appropriate model.
# We will map this field when future EPO versions will provide an appropriate representation for it.
#tedm:ProcessPlanningTermProcedure a rr:TriplesMap ;
#    rr:subjectMap
#        [
#            rml:reference "if (exists(DATE_AWARD_SCHEDULED)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-') || '_ProcessPlanningTerm_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
#            rr:class epo:ProcessPlanningTerm
#        ] ;
#    rml:logicalSource
#        [
#            rml:source "data/source.xml" ;
#            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014[1]/PROCEDURE" ;
#            rml:referenceFormulation ql:XPath
#       ] .
tedm:ProcurementLowestReceivedTenderValue a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014[1]/OBJECT_CONTRACT" ;
            rml:referenceFormulation ql:XPath
        ] ;
    rr:subjectMap
        [
            rml:reference "if (exists(VAL_RANGE_TOTAL/LOW)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-') || '_ProcurementLowestReceivedTenderValue_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
            rr:class epo:MonetaryValue

        ] .
tedm:ProcurementHighestReceivedTenderValue  a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014[1]/OBJECT_CONTRACT" ;
            rml:referenceFormulation ql:XPath
        ] ;
    rr:subjectMap
        [
            rml:reference "if (exists(VAL_RANGE_TOTAL/HIGH)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-') || '_ProcurementHighestReceivedTenderValue_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
            rr:class epo:MonetaryValue

        ] .
tedm:Reviewer a rr:TriplesMap ;
    rr:subjectMap
        [
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-')}_Reviewer_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw')}" ;
            rr:class epo:Reviewer

        ] ;
    rml:logicalSource
    [
        rml:source "data/source.xml" ;
        rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014[1]/COMPLEMENTARY_INFO/ADDRESS_REVIEW_BODY" ;
        rml:referenceFormulation ql:XPath
    ] .

tedm:DirectAwardTerm a rr:TriplesMap ;
    rr:subjectMap
        [
            rml:reference "if (exists(PT_AWARD_CONTRACT_WITHOUT_CALL) or exists(PT_AWARD_CONTRACT_WITHOUT_PUBLICATION)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-') || '_DirectAwardTerm_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
            # rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-')}_DirectAwardTerm_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw')}" ;
            rr:class epo:DirectAwardTerm

        ] ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014/PROCEDURE" ;
            rml:referenceFormulation ql:XPath
        ] .
tedm:PreviousProcedure a rr:TriplesMap ;
    rr:subjectMap
        [
            rml:reference "if(exists(D_PROC_OPEN) or exists(D_PROC_RESTRICTED)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-') || '_PreviousProcedure_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
            rr:class epo:Procedure

        ] ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014/PROCEDURE/PT_AWARD_CONTRACT_WITHOUT_CALL/D_ACCORDANCE_ARTICLE" ;
            rml:referenceFormulation ql:XPath
        ] .
tedm:Procedure a rr:TriplesMap ;
    rr:subjectMap
        [
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-')}_Procedure_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw')}" ;
            rr:class epo:Procedure

        ] ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014/OBJECT_CONTRACT" ;
            rml:referenceFormulation ql:XPath
        ] .
#    rr:predicateObjectMap
#        [
#            rr:predicate epo:hasLegalBasis ;
#            rr:objectMap
#                [
#                    rml:reference "if (not(exists(/TED_EXPORT/FORM_SECTION/F03_2014/CONTRACTING_BODY/ADDRESS_CONTRACTING_BODY/JOINT_PROCUREMENT_INVOLVED/PROCUREMENT_LAW))) then 'http://publications.europa.eu/resource/authority/legal-basis/OP_DATPRO' else null";
#                    rr:termType rr:IRI ;
#                ]
#
#        ] ;
#    rr:predicateObjectMap
#    [
#        rr:predicate epo:hasLegalBasis ;
#        rr:objectMap
#            [
#                rr:parentTriplesMap tedm:legalBasis;
#                rr:joinCondition [
#                        rr:child "/TED_EXPORT/FORM_SECTION/F03_2014/CONTRACTING_BODY/ADDRESS_CONTRACTING_BODY/JOINT_PROCUREMENT_INVOLVED/PROCUREMENT_LAW";
#                        rr:parent "code.value";
#                    ];
#            ] ;
#    ] ;


tedm:ProcurementMonetaryValue a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014[1]/OBJECT_CONTRACT" ;
            rml:referenceFormulation ql:XPath
        ] ;
    rr:subjectMap
        [
            rml:reference "if (exists(VAL_TOTAL)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-') || '_ProcurementMonetaryValue_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
            rr:class epo:MonetaryValue

        ] .
tedm:ProcedureIdentifier a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014[1]/OBJECT_CONTRACT";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rml:reference "if (exists(/TED_EXPORT/FORM_SECTION/F03_2014[1]/OBJECT_CONTRACT/REFERENCE_NUMBER)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-') || '_ProcedureIdentifier_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
            rr:class epo:Identifier
        ] .
tedm:ProcedurePurpose a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014[1]/OBJECT_CONTRACT" ;
            rml:referenceFormulation ql:XPath
        ] ;
    rr:subjectMap
        [
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-')}_ProcedurePurpose_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw')}" ;
            rr:class epo:Purpose

        ] .
#    rr:predicateObjectMap
#        [
#            rr:predicate epo:hasContractNatureType ;
#            rr:objectMap
#                [
#                    rml:reference "if (not(exists(/TED_EXPORT/FORM_SECTION/F03_2014[1]/OBJECT_CONTRACT/TYPE_CONTRACT/@CTYPE))) then 'http://publications.europa.eu/resource/authority/contract-nature/OP_DATPRO' else null";
#                    rr:termType rr:IRI;
#                ]
#
#        ] ;

tedm:PreviousNotice a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014[1]/PROCEDURE" ;
            rml:referenceFormulation ql:XPath
        ] ;
    rr:subjectMap
        [
            rml:reference "if (exists(NOTICE_NUMBER_OJ)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(NOTICE_NUMBER_OJ, ' ', '-' ), '/' , '-') || '_Notice' else null" ;
            rr:class epo:Notice
        ] .
tedm:PreviousNoticeIdentifier a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014[1]/PROCEDURE";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rml:reference "if (exists(NOTICE_NUMBER_OJ)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(NOTICE_NUMBER_OJ, ' ', '-' ), '/' , '-') || '_NoticeIdentifier_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
            rr:class epo:Identifier
        ] .
tedm:Fund a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014/OBJECT_CONTRACT/OBJECT_DESCR" ;
            rml:referenceFormulation ql:XPath
        ] ;
    rr:subjectMap
        [
            rml:reference "if (exists(EU_PROGR_RELATED)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-') || '_Fund_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
            rr:class epo:Fund
        ] .
tedm:Lot a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014/OBJECT_CONTRACT/OBJECT_DESCR" ;
            rml:referenceFormulation ql:XPath
        ] ;
    rr:subjectMap
        [
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-')}_Lot_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw')}" ;
            rr:class epo:Lot
        ] .
tedm:LotIdentifier a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014[1]/OBJECT_CONTRACT/OBJECT_DESCR";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rml:reference "if (exists(LOT_NO)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-') || '_LotIdentifier_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
            rr:class epo:Identifier
        ] ;
    rr:predicateObjectMap
        [
            rr:predicate epo:hasIdentifierValue;
            rr:objectMap
                [
                    rml:reference "/TED_EXPORT/FORM_SECTION/F03_2014/AWARD_CONTRACT[@ITEM=ancestor::OBJECT_DESCR/@ITEM]/LOT_NO";
                ]
        ] .
tedm:LotPurpose a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014[1]/OBJECT_CONTRACT/OBJECT_DESCR/CPV_ADDITIONAL" ;
            rml:referenceFormulation ql:XPath
        ] ;
    rr:subjectMap
        [
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-')}_LotPurpose_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path(..)) || '?response_type=raw')}" ;
            rr:class epo:Purpose
        ] .
tedm:ContractTermProcedure a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014/PROCEDURE" ;
            rml:referenceFormulation ql:XPath
        ] ;
    rr:subjectMap
        [
            rml:reference
                "if (exists(../OBJECT_CONTRACT/TYPE_CONTRACT/@CTYPE) or exists(../COMPLEMENTARY_INFO/EORDERING) or exists(../COMPLEMENTARY_INFO/EINVOICING) or exists(../COMPLEMENTARY_INFO/EPAYMENT)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-') || '_ContractTermProcedure_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
            rr:class epo:ContractTerm
        ] .
tedm:ContractTermLot a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014/OBJECT_CONTRACT/OBJECT_DESCR" ;
            rml:referenceFormulation ql:XPath
        ] ;
    rr:subjectMap
        [
            rml:reference "if (not(../../@FORM='F13')) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-') || '_ContractTermLot_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
            rr:class epo:ContractTerm
        ] .
tedm:ContractTermLotLocation a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014[1]/OBJECT_CONTRACT/OBJECT_DESCR" ;
            rml:referenceFormulation ql:XPath
        ] ;
    rr:subjectMap
        [
            rml:reference "if (not(../../@FORM='F13')) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-') || '_ContractTermLotLocation_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
            rr:class dct:Location

        ] .
tedm:ContractTermLotLocationAddress a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014/OBJECT_CONTRACT/OBJECT_DESCR" ;
            rml:referenceFormulation ql:XPath
        ] ;
    rr:subjectMap
        [
            rml:reference
                "if(exists(MAIN_SITE)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-') || '_ContractTermLotLocationAddress_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
            rr:class locn:Address
        ] .
tedm:AwardCriterionQuality a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014/OBJECT_CONTRACT/OBJECT_DESCR/AC/AC_QUALITY | /TED_EXPORT/FORM_SECTION/F03_2014/OBJECT_CONTRACT/OBJECT_DESCR/AC_QUALITY" ;
            rml:referenceFormulation ql:XPath
        ] ;
    rr:subjectMap
        [
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-')}_AwardCriterionQuality_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw')}" ;
            rr:class epo:AwardCriterion
        ] .
tedm:AwardCriterionPrice a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014/OBJECT_CONTRACT/OBJECT_DESCR/AC/AC_PRICE | /TED_EXPORT/FORM_SECTION/F03_2014/OBJECT_CONTRACT/OBJECT_DESCR/AC_PRICE" ;
            rml:referenceFormulation ql:XPath
        ] ;
    rr:subjectMap
        [
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-')}_AwardCriterionPrice_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw')}" ;
            rr:class epo:AwardCriterion
        ] .
tedm:AwardCriterionCost a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014/OBJECT_CONTRACT/OBJECT_DESCR/AC/AC_COST | /TED_EXPORT/FORM_SECTION/F03_2014/OBJECT_CONTRACT/OBJECT_DESCR/AC_COST" ;
            rml:referenceFormulation ql:XPath
        ] ;
    rr:subjectMap
        [
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-')}_AwardCriterionCost_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw')}" ;
            rr:class epo:AwardCriterion
        ] .

# Section 4
tedm:FrameworkAgreementTechniqueUsage a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014[1]/PROCEDURE" ;
            rml:referenceFormulation ql:XPath
        ] ;
    rr:subjectMap
        [
            rml:reference
                "if(exists(FRAMEWORK)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-') || '_FrameworkAgreementTechniqueUsage_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
            rr:class epo:FrameworkAgreementTechniqueUsage

        ] .
tedm:FrameworkAgreementTerm a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014[1]/PROCEDURE" ;
            rml:referenceFormulation ql:XPath
        ] ;
    rr:subjectMap
        [
            rml:reference
                "if(exists(FRAMEWORK)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-') || '_FrameworkAgreementTerm_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
            rr:class epo:FrameworkAgreementTerm

        ] .
tedm:ProcurementProcessInformation a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014[1]/PROCEDURE" ;
            rml:referenceFormulation ql:XPath
        ] ;
    rr:subjectMap
        [
        rml:reference
            "if(exists(TERMINATION_DPS) or exists(TERMINATION_PIN) or exists(../RESULTS/NO_AWARDED_PRIZE)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-') || '_ProcurementProcessInformation_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
        #rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-')}_ProcurementProcessInformation_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw')}" ;
        rr:class epo:ProcurementProcessInformation

        ] .
tedm:DynamicPurchaseSystemTechniqueUsage a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014[1]/PROCEDURE" ;
            rml:referenceFormulation ql:XPath
        ] ;
    rr:subjectMap
        [
            rml:reference
                "if(exists(DPS)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-') || '_DynamicPurchaseSystemTechniqueUsage_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
            rr:class epo:DynamicPurchaseSystemTechniqueUsage

        ] .
tedm:EAuctionTechniqueUsage  a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014[1]/PROCEDURE" ;
            rml:referenceFormulation ql:XPath
        ] ;
    rr:subjectMap
        [
            rml:reference
                "if(exists(EAUCTION_USED)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-') || '_EAuctionTechniqueUsage_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
            rr:class epo:EAuctionTechniqueUsage
        ] .

# Section 5
#tedm:PurchaseContract a rr:TriplesMap ;
#    rml:logicalSource
#        [
#            rml:source "data/source.xml" ;
#            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014[1]/AWARD_CONTRACT" ;
#            rml:referenceFormulation ql:XPath
#        ] ;
#    rr:subjectMap
#        [
#            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-')}_PurchaseContract_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw')}" ;
#            rr:class epo:PurchaseContract
#        ].

# This mapping was removed as EPO 3.1.0 and the Standard form XSD does not provide appropriate model
# for representing grouping of Winners per TenderAwardOutcome. See GH issue #245
#tedm:ContractorOrganisationGroup a rr:TriplesMap ;
#    rml:logicalSource
#        [
#            rml:source "data/source.xml" ;
#            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014[1]/AWARD_CONTRACT/AWARDED_CONTRACT" ;
#            rml:referenceFormulation ql:XPath
#        ] ;
#    rr:subjectMap
#        [
#            rml:reference "if(exists(CONTRACTORS/AWARDED_TO_GROUP) or exists(AWARDED_TO_GROUP)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-') || '_ContractorOrganisationGroup_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
#            rr:class epo:OrganisationGroup
#
#        ] .
tedm:Contract a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014/AWARD_CONTRACT" ;
            rml:referenceFormulation ql:XPath
        ] ;
    rr:subjectMap
        [
            rml:reference "if (not(../NOTICE/@TYPE='CONCESSION_AWARD_CONTRACT' or ../@FORM='F23' or ../@FORM='F25') and exists(AWARDED_CONTRACT)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-') || '_Contract_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
            rr:class epo:Contract
        ] ;
    rr:predicateObjectMap   #specific for F03, F06, F21, F22, and F20 when used for directive 24 and 25 (different for F25, F23 and F20 with directive 23, for example)
        [
            rr:predicate epo:hasContractConclusionDate;
            rr:objectMap
                [
                    rml:reference "if (../@FORM='F03' or ../@FORM='F06' or ../@FORM='F21' or ../@FORM='F22' or (../@FORM='F20' and (../DIRECTIVE/@VALUE='2014/24/EU' or ../DIRECTIVE/@VALUE='2014/25/EU' or ../LEGAL_BASIS/@VALUE='32014L0024' or ../LEGAL_BASIS/@VALUE='32014L0025' or ../LEGAL_BASIS/@VALUE='32018R1046' or contains(../LEGAL_BASIS_OTHER, '24/EU') or contains(../LEGAL_BASIS_OTHER, 'L0024') or contains(../LEGAL_BASIS_OTHER, '25/EU') or contains(../LEGAL_BASIS_OTHER, 'L0025') ))) then AWARDED_CONTRACT/DATE_CONCLUSION_CONTRACT else null";
                    rr:datatype xsd:date;
                ]
        ] .
tedm:LotAwardOutcome a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014[1]/AWARD_CONTRACT";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-')}_LotAwardOutcome_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw')}" ;
            rr:class epo:LotAwardOutcome
        ] ;
    rr:predicateObjectMap   #specific for F25, F23 and F20 with directive 23 (different for F03, F06, F21, F22, and F20 when used for directive 24 and 25, for example)
        [
            rr:predicate epo:hasAwardDecisionDate;
            rr:objectMap
                [
                    rml:reference "if (../@FORM='F23' or ../@FORM='F25' or (../@FORM='F20' and (../DIRECTIVE/@VALUE='2014/23/EU' or ../LEGAL_BASIS/@VALUE='32014L0023' or contains(../LEGAL_BASIS_OTHER, '23/EU') or contains(../LEGAL_BASIS_OTHER, 'L0023') ))) then AWARDED_CONTRACT/DATE_CONCLUSION_CONTRACT else null";
                    rr:datatype xsd:date;
                ]
         ] ;
    rr:predicateObjectMap   #specific for F13 (similar to F25 and F23, but different from F03 and F06, for example)
        [
            rr:predicate epo:hasAwardDecisionDate;
            rr:objectMap
                [
                    rml:reference "AWARDED_PRIZE/DATE_DECISION_JURY";
                    rr:datatype xsd:date;
                ]
       ] .
tedm:ContractIdentifier a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014[1]/AWARD_CONTRACT";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
#           # Note that here we use a different URI generation pattern as in all the other places
            rml:reference "if (not(../NOTICE/@TYPE='CONCESSION_AWARD_CONTRACT' or ../@FORM='F23' or ../@FORM='F25') and exists(CONTRACT_NO) and exists(AWARDED_CONTRACT)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-') || '_ContractIdentifier_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(CONTRACT_NO) || '?response_type=raw') else null" ;
            rr:class epo:Identifier
        ] .
#tedm:ContractSignatoryonContractorSide a rr:TriplesMap ;
#    rml:logicalSource
#        [
#            rml:source "data/source.xml" ;
#            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014[1]/AWARD_CONTRACT/AWARDED_CONTRACT/CONTRACTORS/CONTRACTOR | /TED_EXPORT/FORM_SECTION/F03_2014[1]/AWARD_CONTRACT/AWARDED_CONTRACT/CONTRACTOR" ;
#            rml:referenceFormulation ql:XPath
#        ] ;
#    rr:subjectMap
#        [
#            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-')}_ContractSignatoryOnContractorSide_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw')}" ;
#            rr:class epo:ContractSignatoryOnContractorSide
#
#        ] .
#tedm:ContractorRole a rr:TriplesMap ;
#    rml:logicalSource
#        [
#            rml:source "data/source.xml" ;
#            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014[1]/AWARD_CONTRACT/AWARDED_CONTRACT/CONTRACTORS/CONTRACTOR | /TED_EXPORT/FORM_SECTION/F03_2014[1]/AWARD_CONTRACT/AWARDED_CONTRACT/CONTRACTOR" ;
#            rml:referenceFormulation ql:XPath
#        ] ;
#    rr:subjectMap
#        [
#            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-')}_ContractorRole_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw')}" ;
#            rr:class epo:Contractor
#
#        ] .
#tedm:TenderRole a rr:TriplesMap ;
#    rml:logicalSource
#        [
#            rml:source "data/source.xml" ;
#            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014[1]/AWARD_CONTRACT/AWARDED_CONTRACT/CONTRACTORS/CONTRACTOR | /TED_EXPORT/FORM_SECTION/F03_2014[1]/AWARD_CONTRACT/AWARDED_CONTRACT/CONTRACTOR" ;
#            rml:referenceFormulation ql:XPath
#        ] ;
#    rr:subjectMap
#        [
#            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-')}_TendererRole_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw')}" ;
#            rr:class epo:Tenderer
#
#        ] .
tedm:Winner a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014[1]/AWARD_CONTRACT/AWARDED_CONTRACT/CONTRACTORS/CONTRACTOR | /TED_EXPORT/FORM_SECTION/F03_2014[1]/AWARD_CONTRACT/AWARDED_CONTRACT/CONTRACTOR" ;
            rml:referenceFormulation ql:XPath
        ] ;
    rr:subjectMap
        [
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-')}_Winner_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw')}" ;
            rr:class epo:Winner

        ] .
#tedm:Business a rr:TriplesMap ;
#    rml:logicalSource
#        [
#            rml:source "data/source.xml" ;
#            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014[1]/AWARD_CONTRACT/AWARDED_CONTRACT/CONTRACTORS/CONTRACTOR | /TED_EXPORT/FORM_SECTION/F03_2014[1]/AWARD_CONTRACT/AWARDED_CONTRACT/CONTRACTOR" ;
#            rml:referenceFormulation ql:XPath
#        ] ;
#    rr:subjectMap
#        [
#            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-')}_Business_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw')}" ;
#            rr:class epo:Business
#
#        ] .
tedm:ContractorOrganisation a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014/AWARD_CONTRACT/AWARDED_CONTRACT/CONTRACTORS/CONTRACTOR | /TED_EXPORT/FORM_SECTION/F03_2014/AWARD_CONTRACT/AWARDED_CONTRACT/CONTRACTOR" ;
            rml:referenceFormulation ql:XPath
        ] ;
    rr:subjectMap
        [
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-')}_ContractorOrganisation_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw')}" ;
            rr:class org:Organization
        ] .

tedm:ContractorOrganisationIdentifier a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014[1]/AWARD_CONTRACT/AWARDED_CONTRACT/CONTRACTORS/CONTRACTOR | /TED_EXPORT/FORM_SECTION/F03_2014[1]/AWARD_CONTRACT/AWARDED_CONTRACT/CONTRACTOR";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rml:reference "if (exists(ADDRESS_CONTRACTOR/NATIONALID)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-') || '_ContractorOrganisationIdentifier_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
            rr:class epo:Identifier
        ] .
tedm:ContractorContactPoint a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014/AWARD_CONTRACT/AWARDED_CONTRACT/CONTRACTORS/CONTRACTOR | /TED_EXPORT/FORM_SECTION/F03_2014/AWARD_CONTRACT/AWARDED_CONTRACT/CONTRACTOR" ;
            rml:referenceFormulation ql:XPath
        ] ;
    rr:subjectMap
        [
            rml:reference
                "if(exists(ADDRESS_CONTRACTOR/E_MAIL) or exists(ADDRESS_CONTRACTOR/FAX) or exists(ADDRESS_CONTRACTOR/PHONE) or exists(ADDRESS_CONTRACTOR/URL) or exists(ADDRESS_CONTRACTOR/CONTACT_POINT)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-') || '_ContractorContactPoint_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
            rr:class cpov:ContactPoint
        ] .
tedm:ContractorOrganisationAddress a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014[1]/AWARD_CONTRACT/AWARDED_CONTRACT/CONTRACTORS/CONTRACTOR | /TED_EXPORT/FORM_SECTION/F03_2014[1]/AWARD_CONTRACT/AWARDED_CONTRACT/CONTRACTOR" ;
            rml:referenceFormulation ql:XPath
        ] ;
    rr:subjectMap
        [
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-')}_ContractorOrganisationAddress_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw')}" ;
            rr:class locn:Address

        ] .
tedm:TenderAwardOutcome a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014[1]/AWARD_CONTRACT/AWARDED_CONTRACT" ;
            rml:referenceFormulation ql:XPath
        ] ;
    rr:subjectMap
        [
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-')}_TenderAwardOutcome_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw')}" ;
            rr:class epo:TenderAwardOutcome
        ] .
tedm:Tender a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014[1]/AWARD_CONTRACT/AWARDED_CONTRACT" ;
            rml:referenceFormulation ql:XPath
        ] ;
    rr:subjectMap
        [
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-')}_Tender_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw')}" ;
            rr:class epo:Tender
#        ] ;
#    rr:predicateObjectMap     #specific for F06    -  Not to be published!
#        [
#            rr:predicate epo:isVariant;
#            rr:objectMap
#                [
#                    rml:reference "if(exists(AWARDED_TENDERER_VARIANT)) then 'true' else if(exists(NO_AWARDED_TENDERER_VARIANT)) then 'false' else null";
#                    rr:datatype xsd:boolean
#                ]
        ] .
tedm:LotAwardOutcomeAwardedMonetaryValue a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014[1]/AWARD_CONTRACT" ;
            rml:referenceFormulation ql:XPath
        ] ;
    rr:subjectMap
        [
            rml:reference "if (exists(AWARDED_CONTRACT/VALUES/VAL_TOTAL) or exists(AWARDED_CONTRACT/VALUE/VAL_TOTAL) or exists(AWARDED_CONTRACT/VAL_TOTAL)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-') || '_LotAwardOutcomeAwardedMonetaryValue_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
            rr:class epo:MonetaryValue

        ] .
tedm:LotAwardOutcomeBargainMonetaryValue a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014[1]/AWARD_CONTRACT" ;
            rml:referenceFormulation ql:XPath
        ] ;
    rr:subjectMap
        [
            rml:reference "if (exists(AWARDED_CONTRACT/VAL_BARGAIN_PURCHASE)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-') || '_LotAwardOutcomeBargainMonetaryValue_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
            rr:class epo:MonetaryValue

        ] .
tedm:SubmissionStatisticalInformation a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014[1]/AWARD_CONTRACT/AWARDED_CONTRACT" ;
            rml:referenceFormulation ql:XPath
        ] ;
    rr:subjectMap
        [
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-')}_SubmissionStatisticalInformation_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw')}" ;
            rr:class epo:SubmissionStatisticalInformation

        ] .
tedm:MonetaryValueSubmissionHighest a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014[1]/AWARD_CONTRACT/AWARDED_CONTRACT" ;
            rml:referenceFormulation ql:XPath
        ] ;
    rr:subjectMap
        [
            rml:reference "if (exists(VALUES/VAL_RANGE_TOTAL/HIGH) or exists(VALUE/VAL_RANGE_TOTAL/HIGH) or exists(VAL_RANGE_TOTAL/HIGH)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-') || '_MonetaryValueSubmissionHighest_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
            rr:class epo:MonetaryValue

        ] .
tedm:MonetaryValueSubmissionLowest a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014[1]/AWARD_CONTRACT/AWARDED_CONTRACT" ;
            rml:referenceFormulation ql:XPath
        ] ;
    rr:subjectMap
        [
            rml:reference "if (exists(VALUES/VAL_RANGE_TOTAL/LOW) or exists(VALUE/VAL_RANGE_TOTAL/LOW) or exists(VAL_RANGE_TOTAL/LOW)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-') || '_MonetaryValueSubmissionLowest_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
            rr:class epo:MonetaryValue

        ] .
tedm:MainMonetaryValueLot a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014[1]/OBJECT_CONTRACT/OBJECT_DESCR" ;
            rml:referenceFormulation ql:XPath
        ] ;
    rr:subjectMap
        [
            rml:reference "if (exists(VAL_OBJECT)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-') || '_MainMonetaryValueLot_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
            rr:class epo:MonetaryValue

        ] .
tedm:MonetaryValueLot a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014[1]/AWARD_CONTRACT/AWARDED_CONTRACT" ;
            rml:referenceFormulation ql:XPath
        ] ;
    rr:subjectMap
        [
            rml:reference "if (exists(VALUES/VAL_ESTIMATED_TOTAL) or exists(VALUE/VAL_ESTIMATED_TOTAL) or exists(VAL_ESTIMATED_TOTAL)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-') || '_MonetaryValueLot_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
            rr:class epo:MonetaryValue

        ] .
tedm:SubcontractingEstimate a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014/AWARD_CONTRACT/AWARDED_CONTRACT" ;
            rml:referenceFormulation ql:XPath
        ] ;
    rr:subjectMap
        [
            rml:reference "if (exists(LIKELY_SUBCONTRACTED)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-') || '_SubcontractingEstimate_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
            rr:class epo:SubcontractingEstimate
        ] .
tedm:SubcontractingEstimatedValueMonetaryValue a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014[1]/AWARD_CONTRACT/AWARDED_CONTRACT" ;
            rml:referenceFormulation ql:XPath
        ] ;
    rr:subjectMap
        [
            rml:reference "if (exists(VAL_SUBCONTRACTING)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-') || '_SubcontractingEstimatedValueMonetaryValue_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
            rr:class epo:MonetaryValue

        ] .
#Section 6
tedm:ReviewerContactPoint a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014/COMPLEMENTARY_INFO/ADDRESS_REVIEW_BODY";
            rml:referenceFormulation ql:XPath
        ] ;
    rr:subjectMap
        [
            rml:reference
                "if(exists(E_MAIL) or exists(FAX) or exists(PHONE) or exists(URL) or exists(CONTACT_POINT)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-') || '_ReviewerContactPoint_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
            rr:class cpov:ContactPoint
        ] .
tedm:ReviewerOrganisationAddress a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014[1]/COMPLEMENTARY_INFO/ADDRESS_REVIEW_BODY";
            rml:referenceFormulation ql:XPath
        ] ;
    rr:subjectMap
        [
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-')}_ReviewerOrganisationAddress_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw')}" ;
            rr:class locn:Address

        ] .
tedm:Mediator a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014[1]/COMPLEMENTARY_INFO/ADDRESS_MEDIATION_BODY" ;
            rml:referenceFormulation ql:XPath
        ] ;
    rr:subjectMap
        [
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-')}_Mediator_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw')}" ;
            rr:class epo:Mediator

        ] .
tedm:MediatorOrganisation a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014/COMPLEMENTARY_INFO/ADDRESS_MEDIATION_BODY" ;
            rml:referenceFormulation ql:XPath
        ] ;
    rr:subjectMap
        [
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-')}_MediatorOrganisation_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw')}" ;
            rr:class org:Organization
        ] .
tedm:MediatorOrganisationIdentifier a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014[1]/COMPLEMENTARY_INFO/ADDRESS_MEDIATION_BODY";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rml:reference "if (exists(NATIONALID)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-') || '_MediatorOrganisationIdentifier_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
            rr:class epo:Identifier
        ] .
tedm:MediatorContactPoint a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014/COMPLEMENTARY_INFO/ADDRESS_MEDIATION_BODY";
            rml:referenceFormulation ql:XPath
        ] ;
    rr:subjectMap
        [
            rml:reference "if(exists(E_MAIL) or exists(FAX) or exists(PHONE) or exists(URL) or exists(CONTACT_POINT)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-') || '_MediatorContactPoint_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
            rr:class cpov:ContactPoint
        ] .
tedm:MediatorOrganisationAddress a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014[1]/COMPLEMENTARY_INFO/ADDRESS_MEDIATION_BODY";
            rml:referenceFormulation ql:XPath
        ] ;
    rr:subjectMap
        [
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-')}_MediatorOrganisationAddress_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw')}" ;
            rr:class locn:Address

        ] .
tedm:ReviewProcedureInformationProvider a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014[1]/COMPLEMENTARY_INFO/ADDRESS_REVIEW_INFO" ;
            rml:referenceFormulation ql:XPath
        ] ;
    rr:subjectMap
        [
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-')}_ReviewProcedureInformationProvider_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw')}" ;
            rr:class epo:ReviewProcedureInformationProvider

        ] .
tedm:ReviewProcedureInformationProviderOrganisation a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014/COMPLEMENTARY_INFO/ADDRESS_REVIEW_INFO" ;
            rml:referenceFormulation ql:XPath
        ] ;
    rr:subjectMap
        [
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-')}_ReviewProcedureInformationProviderOrganisation_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw')}" ;
            rr:class org:Organization
        ] .
tedm:ReviewProcedureInformationProviderOrganisationIdentifier a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014[1]/COMPLEMENTARY_INFO/ADDRESS_REVIEW_INFO";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rml:reference "if (exists(NATIONALID)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-') || '_ReviewProcedureInformationProviderOrganisationIdentifier_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
            rr:class epo:Identifier
        ] .
tedm:ReviewProcedureInformationProviderContactPoint a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014/COMPLEMENTARY_INFO/ADDRESS_REVIEW_INFO";
            rml:referenceFormulation ql:XPath
        ] ;
    rr:subjectMap
        [
            rml:reference "if(exists(E_MAIL) or exists(FAX) or exists(PHONE) or exists(URL) or exists(CONTACT_POINT)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-') || '_ReviewProcedureInformationProviderContactPoint_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
            rr:class cpov:ContactPoint
        ] .
tedm:ReviewProcedureInformationProviderOrganisationAddress a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014[1]/COMPLEMENTARY_INFO/ADDRESS_REVIEW_INFO";
            rml:referenceFormulation ql:XPath
        ] ;
    rr:subjectMap
        [
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-')}_ReviewProcedureInformationProviderAddress_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw')}" ;
            rr:class locn:Address
        ] .
tedm:ReviewerOrganisation a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014/COMPLEMENTARY_INFO/ADDRESS_REVIEW_BODY" ;
            rml:referenceFormulation ql:XPath
        ] ;
    rr:subjectMap
        [
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-')}_ReviewerOrganisation_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw')}" ;
            rr:class org:Organization
        ] .
tedm:ReviewerOrganisationIdentifier a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014[1]/COMPLEMENTARY_INFO/ADDRESS_REVIEW_BODY";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rml:reference "if (exists(NATIONALID)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-') || '_ReviewerOrganisationIdentifier_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
            rr:class epo:Identifier
        ] .
tedm:ReviewTerm a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014[1]/COMPLEMENTARY_INFO";
            rml:referenceFormulation ql:XPath
        ];
    rr:subjectMap
        [
            rml:reference
                "if(exists(REVIEW_PROCEDURE)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-') || '_ReviewTerm_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
            rr:class epo:ReviewTerm
        ] .
#F25 mappings
tedm:MonetaryValueProcedure a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014[1]/OBJECT_CONTRACT" ;
            rml:referenceFormulation ql:XPath
        ] ;
    rr:subjectMap
        [
            rml:reference "if (exists(VAL_ESTIMATED_TOTAL)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-') || '_MonetaryValueProcedure_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
            rr:class epo:MonetaryValue

        ] .
tedm:AwardCriterion a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014/OBJECT_CONTRACT/OBJECT_DESCR/AC/AC_CRITERION | /TED_EXPORT/FORM_SECTION/F03_2014/OBJECT_CONTRACT/OBJECT_DESCR/AC_CRITERION" ;
            rml:referenceFormulation ql:XPath
        ] ;
    rr:subjectMap
        [
            rml:reference
                "'http://data.europa.eu/a4g/resource/id_' || replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-') || '_AwardCriterion_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw')" ;
            rr:class epo:AwardCriterion
        ] .
tedm:ConcessionEstimate a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014[1]/AWARD_CONTRACT/AWARDED_CONTRACT" ;
            rml:referenceFormulation ql:XPath
        ] ;
    rr:subjectMap
        [
            rml:reference "if (exists(VAL_PRICE_PAYMENT) or exists(INFO_ADD_VALUE) or exists (VAL_REVENUE)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-') || '_ConcessionEstimate_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
            rr:class epo:ConcessionEstimate

        ] .
tedm:UserConcessionRevenueMonetaryValue a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014[1]/AWARD_CONTRACT/AWARDED_CONTRACT" ;
            rml:referenceFormulation ql:XPath
        ] ;
    rr:subjectMap
        [
            rml:reference "if (exists(VAL_REVENUE)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-') || '_UserConcessionRevenueMonetaryValue_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
            rr:class epo:MonetaryValue

        ] .
tedm:BuyerConcessionRevenueMonetaryValue a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014[1]/AWARD_CONTRACT/AWARDED_CONTRACT" ;
            rml:referenceFormulation ql:XPath
        ] ;
    rr:subjectMap
        [
            rml:reference "if (exists(VAL_PRICE_PAYMENT)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-') || '_BuyerConcessionRevenueMonetaryValue_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
            rr:class epo:MonetaryValue
        ] .
tedm:Duration a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014/OBJECT_CONTRACT/OBJECT_DESCR/DURATION" ;
            rml:referenceFormulation ql:XPath
        ] ;
    rr:subjectMap
        [
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-')}_Duration_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw')}" ;
#            rr:class epo:Duration
            rr:class epo:SpecificDuration
        ] .
tedm:Period a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014/OBJECT_CONTRACT/OBJECT_DESCR" ;
            rml:referenceFormulation ql:XPath
        ] ;
    rr:subjectMap
        [
            rml:reference
                "if(exists(DATE_START) or exists(DATE_END)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-') || '_Period_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
            rr:class epo:Period
        ] .

#F22 TriplesMap
tedm:AccessTerm  a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014/CONTRACTING_BODY" ;
            rml:referenceFormulation ql:XPath
        ] ;
    rr:subjectMap
        [
            rml:reference
                "if(exists(DOCUMENT_FULL) or exists(DOCUMENT_RESTRICTED) or exists(URL_DOCUMENT)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-') || '_AccessTerm_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
            rr:class epo:AccessTerm
        ] .
tedm:ElectronicCommunicationChannel a rr:TriplesMap ;
    rr:subjectMap
        [
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-')}_Channel_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw')}" ;
            rr:class cv:Channel
        ] ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014[1]/CONTRACTING_BODY/URL_TOOL" ;
            rml:referenceFormulation ql:XPath
        ] .
tedm:ProcurementProcedureInformationProviderIdem  a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014/CONTRACTING_BODY/ADDRESS_FURTHER_INFO_IDEM" ;
            rml:referenceFormulation ql:XPath
        ] ;
    rr:subjectMap
        [
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-')}_ProcurementProcedureInformationProvider_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw')}" ;
            rr:class epo:ProcurementProcedureInformationProvider
        ] .
tedm:ProcurementProcedureInformationProvider  a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014/CONTRACTING_BODY/ADDRESS_FURTHER_INFO" ;
            rml:referenceFormulation ql:XPath
        ] ;
    rr:subjectMap
        [
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-')}_ProcurementProcedureInformationProvider_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw')}" ;
            rr:class epo:ProcurementProcedureInformationProvider
        ] .
tedm:InformationProviderOrganisation a rr:TriplesMap ;
    rr:subjectMap
        [
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-')}_InformationProviderOrganisation_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw')}" ;
            rr:class org:Organization
        ] ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014/CONTRACTING_BODY/ADDRESS_FURTHER_INFO" ;
            rml:referenceFormulation ql:XPath
        ] .
tedm:InformationProviderOrganisationIdentifier a rr:TriplesMap ;
    rr:subjectMap
        [
            rml:reference "if (exists(NATIONALID)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-') || '_InformationProviderOrganisationIdentifier_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
            rr:class epo:Identifier
        ] ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014[1]/CONTRACTING_BODY/ADDRESS_FURTHER_INFO";
            rml:referenceFormulation ql:XPath
        ].
tedm:InformationProviderContactPoint a rr:TriplesMap ;
    rr:subjectMap
        [
            rml:reference "if(exists(E_MAIL) or exists(FAX) or exists(PHONE) or exists(URL_GENERAL) or exists(CONTACT_POINT)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-') || '_InformationProviderContactPoint_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
            rr:class cpov:ContactPoint
        ] ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014/CONTRACTING_BODY/ADDRESS_FURTHER_INFO" ;
            rml:referenceFormulation ql:XPath
        ] .
tedm:InformationProviderOrganisationAddress  a rr:TriplesMap ;
    rr:subjectMap
        [
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-')}_InformationProviderOrganisationAddress_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw')}" ;
            rr:class locn:Address
        ] ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014[1]/CONTRACTING_BODY/ADDRESS_FURTHER_INFO" ;
            rml:referenceFormulation ql:XPath
        ] .
tedm:TenderReceiverIdem  a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014/CONTRACTING_BODY/ADDRESS_PARTICIPATION_IDEM" ;
            rml:referenceFormulation ql:XPath
        ] ;
    rr:subjectMap
        [
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-')}_TenderReceiver_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw')}" ;
            rr:class epo:TenderReceiver
        ] .
tedm:TenderReceiver  a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014/CONTRACTING_BODY/ADDRESS_PARTICIPATION" ;
            rml:referenceFormulation ql:XPath
        ] ;
    rr:subjectMap
        [
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-')}_TenderReceiver_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw')}" ;
            rr:class epo:TenderReceiver
        ] .
tedm:TenderReceiverOrganisation a rr:TriplesMap ;
    rr:subjectMap
        [
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-')}_TenderReceiverOrganisation_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw')}" ;
            rr:class org:Organization
        ] ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014/CONTRACTING_BODY/ADDRESS_PARTICIPATION" ;
            rml:referenceFormulation ql:XPath
        ] .
tedm:TenderReceiverOrganisationIdentifier a rr:TriplesMap ;
    rr:subjectMap
        [
            rml:reference "if (exists(NATIONALID)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-') || '_TenderReceiverOrganisationIdentifier_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
            rr:class epo:Identifier
        ] ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014[1]/CONTRACTING_BODY/ADDRESS_PARTICIPATION";
            rml:referenceFormulation ql:XPath
        ].
tedm:TenderReceiverOrganisationContactPoint a rr:TriplesMap ;
    rr:subjectMap
        [
            rml:reference "if(exists(E_MAIL) or exists(FAX) or exists(PHONE) or exists(URL_GENERAL) or exists(CONTACT_POINT)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-') || '_TenderReceiverOrganisationContactPoint_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
            rr:class cpov:ContactPoint
        ] ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014/CONTRACTING_BODY/ADDRESS_PARTICIPATION" ;
            rml:referenceFormulation ql:XPath
        ] .
tedm:TenderReceiverOrganisationAddress  a rr:TriplesMap ;
    rr:subjectMap
        [
            rr:template "http://data.europa.eu/a4g/resource/id_{replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-')}_TenderReceiverOrganisationAddress_{unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw')}" ;
            rr:class locn:Address
        ] ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014[1]/CONTRACTING_BODY/ADDRESS_PARTICIPATION" ;
            rml:referenceFormulation ql:XPath
        ] .
tedm:FrameworkAgreementTermLot a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014[1]/OBJECT_CONTRACT/OBJECT_DESCR" ;
            rml:referenceFormulation ql:XPath
        ] ;
    rr:subjectMap
        [
            rml:reference
                "if(exists(JUSTIFICATION)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-') || '_FrameworkAgreementTermLot_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
            rr:class epo:FrameworkAgreementTerm
        ] .
tedm:MultipleStageProcedureTerm a rr:TriplesMap ;
    rr:subjectMap
        [
            rml:reference "if(exists(QS/INDEFINITE_DURATION) or exists(QS/DATE_START) or exists(QS/DATE_END) or exists(RENEWAL) or exists(RENEWAL_DESC)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-') || '_MultipleStageProcedureTerm_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
            rr:class epo:MultipleStageProcedureTerm

        ] ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014/OBJECT_CONTRACT/OBJECT_DESCR" ;
            rml:referenceFormulation ql:XPath
        ] .
tedm:MultipleStageProcedureIndefiniteDuration a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014/OBJECT_CONTRACT/OBJECT_DESCR" ;
            rml:referenceFormulation ql:XPath
        ] ;
    rr:subjectMap
        [
            rml:reference
                "if(exists(QS/INDEFINITE_DURATION)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-') || '_IndefiniteDuration' else null" ;
#            rr:class epo:Duration
            rr:class epo:IndefiniteDuration
        ] .
tedm:MultipleStageProcedurePeriod a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014/OBJECT_CONTRACT/OBJECT_DESCR" ;
            rml:referenceFormulation ql:XPath
        ] ;
    rr:subjectMap
        [
            rml:reference
                "if(exists(QS/DATE_START) or exists(QS/DATE_END)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-') || '_MultipleStageProcedurePeriod_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
            rr:class epo:Period
        ] .
tedm:ProcedureTerm a rr:TriplesMap ;
    rr:subjectMap
        [
            rml:reference
                "if(exists(../PROCEDURE/URL_NATIONAL_PROCEDURE) or exists(../OBJECT_CONTRACT/LOT_DIVISION/*) or exists(../CONTRACTING_BODY/PROCUREMENT_LAW) or exists(../CONTRACTING_BODY/CENTRAL_PURCHASING)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-') || '_ProcedureTerm_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
            rr:class epo:ProcedureTerm
        ] ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014/OBJECT_CONTRACT" ;
            rml:referenceFormulation ql:XPath
        ] .
tedm:SubmissionTerm a rr:TriplesMap ;
    rr:subjectMap
        [
            rml:reference
                "if(exists(DATE_RECEIPT_TENDERS) or exists(TIME_RECEIPT_TENDERS) or exists(../CONTRACTING_BODY/URL_PARTICIPATION)) then 'http://data.europa.eu/a4g/resource/id_' || replace(replace(/TED_EXPORT/CODED_DATA_SECTION/NOTICE_DATA/NO_DOC_OJS, ' ', '-' ), '/' , '-') || '_SubmissionTerm_' || unparsed-text('https://digest-api.ted-data.eu/api/v1/hashing/fn/uuid/' || encode-for-uri(path()) || '?response_type=raw') else null" ;
            rr:class epo:SubmissionTerm
        ] ;
    rml:logicalSource
        [
            rml:source "data/source.xml" ;
            rml:iterator "/TED_EXPORT/FORM_SECTION/F03_2014/PROCEDURE" ;
            rml:referenceFormulation ql:XPath
        ] .
# controlled values
tedm:contractNature  a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "transformation/resources/contract_nature.json" ;
            rml:iterator "$.results.bindings[*]" ;
            rml:referenceFormulation ql:JSONPath
        ] ;
    rr:subjectMap
        [
            rml:reference
                "conceptURI.value" ;
        ] .
# Not mapping supplementary CPV codes, as EPO does not provide a way to group them with "regular" CPV codes. See issues #119 and #205.
#tedm:cpvsuppl a rr:TriplesMap ;
#    rml:logicalSource
#        [
#            rml:source "transformation/resources/cpvsuppl.json" ;
#            rml:iterator "$.results.bindings[*]" ;
#            rml:referenceFormulation ql:JSONPath
#        ] ;
#    rr:subjectMap
#        [
#            rml:reference
#                "conceptURI.value" ;
#        ] .
tedm:cpv a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "transformation/resources/cpv.json" ;
            rml:iterator "$.results.bindings[*]" ;
            rml:referenceFormulation ql:JSONPath
        ] ;
    rr:subjectMap
        [
            rml:reference
                "conceptURI.value" ;
        ] .
#not needed for forms F06,F20,F22
tedm:buyerLegalType a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "transformation/resources/buyer_legal_type.csv" ;
            rml:referenceFormulation ql:CSV
        ] ;
    rr:subjectMap
        [
            rml:reference
                "conceptURI" ;
        ] .
tedm:currency a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "transformation/resources/currency.json" ;
            rml:iterator "$.results.bindings[*]" ;
            rml:referenceFormulation ql:JSONPath
        ] ;
    rr:subjectMap
        [
            rml:reference
                "conceptURI.value" ;
        ] .
#not needed for forms F20
tedm:mainActivity a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "transformation/resources/main_activity.csv" ;
            rml:referenceFormulation ql:CSV
        ] ;
    rr:subjectMap
        [
            rml:reference
                "conceptURI" ;
        ] .

tedm:legalBasis a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "transformation/resources/legal_basis.json" ;
            rml:iterator "$.results.bindings[*]" ;
            rml:referenceFormulation ql:JSONPath
        ] ;
    rr:subjectMap
        [
            rml:reference
                "conceptURI.value" ;
        ] .

tedm:nuts a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "transformation/resources/nuts.json" ;
            rml:iterator "$.results.bindings[*]" ;
            rml:referenceFormulation ql:JSONPath
        ] ;
    rr:subjectMap
        [
            rml:reference
                "conceptURI.value" ;
        ] .
tedm:country a rr:TriplesMap ;
    rml:logicalSource
        [
            rml:source "transformation/resources/country.json" ;
            rml:iterator "$.results.bindings[*]" ;
            rml:referenceFormulation ql:JSONPath
        ] ;
    rr:subjectMap
        [
            rml:reference
                "conceptURI.value" ;
        ] .
